<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>11.Pandas库 | ‘太湖之光也有报错的情况'</title><meta name="author" content="ZI YUAN"><meta name="copyright" content="ZI YUAN"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="主要介绍了数据分析库Pandas中DataFrame对象的创建、性质、运算等基本操作，包括合并、分组、数据透视表。">
<meta property="og:type" content="website">
<meta property="og:title" content="11.Pandas库">
<meta property="og:url" content="https://ziyuan0315.github.io/2025/03/11/11-Pandas%E5%BA%93/index.html">
<meta property="og:site_name" content="‘太湖之光也有报错的情况&#39;">
<meta property="og:description" content="主要介绍了数据分析库Pandas中DataFrame对象的创建、性质、运算等基本操作，包括合并、分组、数据透视表。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ziyuan0315.github.io/img/the_Alps.jpg">
<meta property="article:published_time" content="2025-03-11T07:50:51.000Z">
<meta property="article:modified_time" content="2025-03-12T13:29:51.246Z">
<meta property="article:author" content="ZI YUAN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ziyuan0315.github.io/img/the_Alps.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ziyuan0315.github.io/2025/03/11/11-Pandas%E5%BA%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '11.Pandas库',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'title'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://i.loli.net/2019/09/09/5oDRkWVKctx2b6A.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ziyuan.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page fixed" id="page-header" style="background-image: url(/img/winter1.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/Sophon.jpg" alt="Logo"><span class="site-name">‘太湖之光也有报错的情况'</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="page-site-info"><h1 id="site-title">11.Pandas库</h1></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="pandas库有什么用？"><a href="#pandas库有什么用？" class="headerlink" title="pandas库有什么用？"></a>pandas库有什么用？</h1><p>Numpy在向量化计算中表现优异</p>
<p>但在处理更灵活、更复杂的数据任务：</p>
<p>为数据添加标签、处理缺失值、分组和做数据透视表等方面</p>
<p>Numpy并没有很大的优势</p>
<p>而基于Numpy构建的Pandas库，提供了使得数据分析变得更快更便捷的高级数据结构和操作工具</p>
<h1 id="一-对象的创建"><a href="#一-对象的创建" class="headerlink" title="一 对象的创建"></a>一 对象的创建</h1><h2 id="1-1-Pandas-series-对象"><a href="#1-1-Pandas-series-对象" class="headerlink" title="1.1 Pandas series 对象"></a>1.1 Pandas series 对象</h2><p>serise是带标签数据的一维数组</p>
<p>Series对象的创建</p>
<p>通用结构：pd.Series(data,index&#x3D;index,dtype&#x3D;dtype)</p>
<p>data:数据，可以是列表，字典或者Numpy数组</p>
<p>index:索引，为可选参数</p>
<p>dtype:数据类型，为可选参数</p>
<h3 id="1-1-1用列表创建"><a href="#1-1-1用列表创建" class="headerlink" title="1.1.1用列表创建"></a>1.1.1用列表创建</h3><ul>
<li>index缺省，默认为整数序列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1.5</span>, <span class="number">3</span>, <span class="number">4.5</span>, <span class="number">6</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>0    1.5
1    3.0
2    4.5
3    6.0
dtype: float64
</code></pre>
<ul>
<li>增加index</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1.5</span>, <span class="number">3</span>, <span class="number">4.5</span>, <span class="number">6</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>a    1.5
b    3.0
c    4.5
d    6.0
dtype: float64
</code></pre>
<ul>
<li>增加数据类型</li>
</ul>
<p>如果定义的时候数据类型是缺省的，则根据元素自动判断</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>a    1
b    3
c    4
d    6
dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], dtype=<span class="string">&#x27;float&#x27;</span>) </span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>a    1.0
b    3.0
c    4.0
d    6.0
dtype: float64
</code></pre>
<ul>
<li>数据支持多种类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>, <span class="number">4</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>a    1
b    2
c    3
d    4
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;a&#x27;</span>]</span><br></pre></td></tr></table></figure>


<pre><code>1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;c&#x27;</span>]</span><br></pre></td></tr></table></figure>


<pre><code>&#39;3&#39;
</code></pre>
<ul>
<li>数据类型可以强制改变</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>, <span class="number">4</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], dtype=<span class="string">&#x27;float&#x27;</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<pre><code>a    1.0
b    2.0
c    3.0
d    4.0
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;c&#x27;</span>]</span><br></pre></td></tr></table></figure>


<pre><code>3.0
</code></pre>
<ul>
<li>如果不能强制改变，会报错</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># data = pd.Series([1, 2, &#x27;a&#x27;, 4], index=[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;], dtype=&#x27;float&#x27;)</span></span><br><span class="line"><span class="comment"># data</span></span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-用一位数组numpy创建"><a href="#1-1-2-用一位数组numpy创建" class="headerlink" title="1.1.2 用一位数组numpy创建"></a>1.1.2 用一位数组numpy创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">pd.Series(x)</span><br></pre></td></tr></table></figure>


<pre><code>0    0
1    1
2    2
3    3
4    4
dtype: int32
</code></pre>
<h3 id="1-1-3-用字典创建"><a href="#1-1-3-用字典创建" class="headerlink" title="1.1.3 用字典创建"></a>1.1.3 用字典创建</h3><ul>
<li>默认以键为index值为data</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">&#x27;BeiJing&#x27;</span>: <span class="number">2189</span>,</span><br><span class="line">                  <span class="string">&#x27;ShangHai&#x27;</span>: <span class="number">2487</span>,</span><br><span class="line">                  <span class="string">&#x27;GuangZhou&#x27;</span>: <span class="number">1867</span>,</span><br><span class="line">                  <span class="string">&#x27;ShenZhen&#x27;</span>:<span class="number">1756</span>&#125;</span><br><span class="line">population = pd.Series(population_dict)</span><br><span class="line">population</span><br></pre></td></tr></table></figure>


<pre><code>BeiJing      2189
ShangHai     2487
GuangZhou    1867
ShenZhen     1756
dtype: int64
</code></pre>
<ul>
<li>字典创建，如果指定index，则会到字典键中筛选，找不到的，值设为NaN</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">population = pd.Series(population_dict, </span><br><span class="line">                       index=[<span class="string">&#x27;BeiJing&#x27;</span>, <span class="string">&#x27;ShangHai&#x27;</span>,<span class="string">&#x27;Hangzhou&#x27;</span>,<span class="string">&#x27;TianJin&#x27;</span>])</span><br><span class="line">population</span><br></pre></td></tr></table></figure>


<pre><code>BeiJing     2189.0
ShangHai    2487.0
Hangzhou       NaN
TianJin        NaN
dtype: float64
</code></pre>
<h3 id="1-1-4-data为标量的情况"><a href="#1-1-4-data为标量的情况" class="headerlink" title="1.1.4 data为标量的情况"></a>1.1.4 data为标量的情况</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(<span class="number">5</span>, index=[<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>])</span><br></pre></td></tr></table></figure>


<pre><code>100    5
200    5
300    5
dtype: int64
</code></pre>
<h2 id="1-2-Pandas-DataFrame对象"><a href="#1-2-Pandas-DataFrame对象" class="headerlink" title="1.2 Pandas DataFrame对象"></a>1.2 Pandas DataFrame对象</h2><p>DataFrame是带标签数据的多维数组</p>
<p>DataFrame是带标签数据的多维数组</p>
<p>通用结构：pd.DataFrame(data, index&#x3D;index, columns&#x3D;coluumns)</p>
<p>data:数据，可以是列表，字典或Numpy数组</p>
<p>index:索引，为可选参数</p>
<p>columns:列标签，为可选参数</p>
<h3 id="1-2-1-通过Series对象创建"><a href="#1-2-1-通过Series对象创建" class="headerlink" title="1.2.1 通过Series对象创建"></a>1.2.1 通过Series对象创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">&#x27;BeiJing&#x27;</span>: <span class="number">2189</span>,</span><br><span class="line">                  <span class="string">&#x27;ShangHai&#x27;</span>: <span class="number">2487</span>,</span><br><span class="line">                  <span class="string">&#x27;GuangZhou&#x27;</span>: <span class="number">1867</span>,</span><br><span class="line">                  <span class="string">&#x27;ShenZhen&#x27;</span>:<span class="number">1756</span>&#125;</span><br><span class="line">population = pd.Series(population_dict)</span><br><span class="line">df = pd.DataFrame(population)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
    </tr>
  </tbody>
</table>
有行标签，没有列标签，默认0，1……

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(population, columns=[<span class="string">&#x27;population&#x27;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
    </tr>
  </tbody>
</table>


<h3 id="1-2-2-通过Series对象字典创建"><a href="#1-2-2-通过Series对象字典创建" class="headerlink" title="1.2.2 通过Series对象字典创建"></a>1.2.2 通过Series对象字典创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GDP_dict = &#123;<span class="string">&#x27;BeiJing&#x27;</span>: <span class="number">36102</span>,</span><br><span class="line">             <span class="string">&#x27;ShangHai&#x27;</span>: <span class="number">38700</span>,</span><br><span class="line">             <span class="string">&#x27;GuangZhou&#x27;</span>: <span class="number">25019</span>,</span><br><span class="line">             <span class="string">&#x27;ShenZhen&#x27;</span>:<span class="number">27670</span>&#125;</span><br><span class="line"></span><br><span class="line">GDP = pd.Series(GDP_dict)</span><br><span class="line">GDP</span><br></pre></td></tr></table></figure>


<pre><code>BeiJing      36102
ShangHai     38700
GuangZhou    25019
ShenZhen     27670
dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;population&#x27;</span>: population,</span><br><span class="line">                  <span class="string">&quot;GDP&quot;</span>:GDP&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
    </tr>
  </tbody>
</table>

<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;population&#x27;</span>: population,</span><br><span class="line">                  <span class="string">&quot;GDP&quot;</span>:GDP,</span><br><span class="line">                  <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>China</td>
    </tr>
  </tbody>
</table>
### 1.2.3 通过字典列表对象创建

* 字典索引作为index，字典键作为columns

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = [&#123;<span class="string">&#x27;a&#x27;</span>:i,<span class="string">&#x27;b&#x27;</span>:<span class="number">2</span>*i&#125;<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


    [{'a': 0, 'b': 0}, {'a': 1, 'b': 2}, {'a': 2, 'b': 4}]

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>


* 不存在的键，会默认值为NaN

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = [&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>:<span class="number">1</span>&#125;, &#123;<span class="string">&#x27;b&#x27;</span>:<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>:<span class="number">4</span>&#125;]</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


    [{'a': 1, 'b': 1}, {'b': 3, 'c': 4}]

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>


### 1.2.4 通过Numpy二维数组创建

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randint(<span class="number">20</span>, size=(<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


    array([[ 4,  9,  8],
           [17,  7,  7],
           [13, 13, 13]])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data, columns=[<span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;II&#x27;</span>, <span class="string">&#x27;III&#x27;</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>I</th>
      <th>II</th>
      <th>III</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>4</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th>b</th>
      <td>17</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>c</th>
      <td>13</td>
      <td>13</td>
      <td>13</td>
    </tr>
  </tbody>
</table>


# 2.DataFrame的性质

## 2.1属性

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(&#123;<span class="string">&#x27;population&#x27;</span>: population,</span><br><span class="line">                  <span class="string">&quot;GDP&quot;</span>:GDP,</span><br><span class="line">                  <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>&#125;)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>China</td>
    </tr>
  </tbody>
</table>


### 2.1.1 df.values返回numpy数组表示的数据

* 丢掉标签，只要数据

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.values</span><br></pre></td></tr></table></figure>


    array([[2189, 36102, 'China'],
           [2487, 38700, 'China'],
           [1867, 25019, 'China'],
           [1756, 27670, 'China']], dtype=object)



### 2.1.2 df.index 返回行索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.index</span><br></pre></td></tr></table></figure>


    Index(['BeiJing', 'ShangHai', 'GuangZhou', 'ShenZhen'], dtype='object')



### 2.1.3 df.columns 返回列索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.columns</span><br></pre></td></tr></table></figure>


    Index(['population', 'GDP', 'country'], dtype='object')



### 2.1.4 df.shape形状

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>


    (3, 3)



### 2.1.5 df.size大小

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.size</span><br></pre></td></tr></table></figure>


    9



### 2.1.6 df.dtypes返回每列数据类型

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>


    I      int32
    II     int32
    III    int32
    dtype: object



## 2.2 索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(&#123;<span class="string">&#x27;population&#x27;</span>: population,</span><br><span class="line">                  <span class="string">&quot;GDP&quot;</span>:GDP,</span><br><span class="line">                  <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>&#125;)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>China</td>
    </tr>
  </tbody>
</table>




### 2.2.1 获取列
* 字典式

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;population&#x27;</span>]</span><br></pre></td></tr></table></figure>


    BeiJing      2189
    ShangHai     2487
    GuangZhou    1867
    ShenZhen     1756
    Name: population, dtype: int64

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[[<span class="string">&#x27;GDP&#x27;</span>, <span class="string">&#x27;population&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>36102</td>
      <td>2189</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>38700</td>
      <td>2487</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>25019</td>
      <td>1867</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>27670</td>
      <td>1756</td>
    </tr>
  </tbody>
</table>


* 对象属性式

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.GDP</span><br></pre></td></tr></table></figure>


    BeiJing      36102
    ShangHai     38700
    GuangZhou    25019
    ShenZhen     27670
    Name: GDP, dtype: int64



### 2.2.2 获取行

* 绝对索引 df.loc

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">&#x27;BeiJing&#x27;</span>]</span><br></pre></td></tr></table></figure>


    population     2189
    GDP           36102
    country       China
    Name: BeiJing, dtype: object

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[[<span class="string">&#x27;BeiJing&#x27;</span>, <span class="string">&#x27;ShangHai&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
  </tbody>
</table>


* 相互索引 df.iloc

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>China</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>


    population     2189
    GDP           36102
    country       China
    Name: BeiJing, dtype: object

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[[<span class="number">0</span>, <span class="number">1</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
  </tbody>
</table>
### 2.2.3 获取标量

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>China</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>China</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">&#x27;BeiJing&#x27;</span>,<span class="string">&#x27;GDP&#x27;</span>]</span><br></pre></td></tr></table></figure>


    36102

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>


    36102

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.values[<span class="number">0</span>][<span class="number">1</span>]</span><br></pre></td></tr></table></figure>


    36102



### 2.2.4 Series对象的索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span>(data.GDP)</span><br></pre></td></tr></table></figure>


    pandas.core.series.Series

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GDP</span><br></pre></td></tr></table></figure>


    BeiJing      36102
    ShangHai     38700
    GuangZhou    25019
    ShenZhen     27670
    dtype: int64

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GDP[<span class="string">&#x27;BeiJing&#x27;</span>]</span><br></pre></td></tr></table></figure>


    36102



## 2.3 切片

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成一个行标签使用罗马数字从I开始，列表标签的字母从A开始的6*6数组，内容为三位数的随机正整数</span></span><br><span class="line">data = np.random.randint(<span class="number">100</span>, <span class="number">1000</span> ,size=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">row_labels = [<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>]</span><br><span class="line">col_labels = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">df = pd.DataFrame(data,index=row_labels,columns=col_labels)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
### 2.3.1 行切片

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;I&#x27;</span>:<span class="string">&#x27;III&#x27;</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">1</span>:<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">1</span>:<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
  </tbody>
</table>


### 2.3.2 列切片

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">&#x27;A&#x27;</span>:<span class="string">&#x27;C&#x27;</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
    </tr>
  </tbody>
</table>
### 2.2.3 多种多样的取值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
* 行、列同时切片

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;I&#x27;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;D&quot;</span>:<span class="string">&quot;F&quot;</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
    <tr>
      <th>V</th>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
  </tbody>
</table>
* 行分散取值，列切片

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;I&#x27;</span>:<span class="string">&quot;V&quot;</span>, [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;D&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>696</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>984</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>782</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>980</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>138</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">3</span>:, [<span class="number">0</span>, <span class="number">2</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>878</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>331</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>669</td>
    </tr>
  </tbody>
</table>
* 行切片，列分散取值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[[<span class="string">&#x27;I&#x27;</span>, <span class="string">&quot;V&quot;</span>], <span class="string">&#x27;A&#x27;</span>:<span class="string">&#x27;D&#x27;</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">1</span>, <span class="number">5</span>], <span class="number">0</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
    </tr>
  </tbody>
</table>
* 行、列分散取值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[[<span class="string">&#x27;I&#x27;</span>, <span class="string">&quot;V&quot;</span>], [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>696</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>138</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">1</span>, <span class="number">5</span>], [<span class="number">0</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>984</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>570</td>
    </tr>
  </tbody>
</table>
## 2.4 布尔索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df &gt; <span class="number">500</span></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>II</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>III</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>V</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df&gt;<span class="number">500</span>]</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>906.0</td>
      <td>696.0</td>
      <td>666.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823.0</td>
      <td>763.0</td>
      <td>NaN</td>
      <td>984.0</td>
      <td>NaN</td>
      <td>846.0</td>
    </tr>
    <tr>
      <th>III</th>
      <td>NaN</td>
      <td>911.0</td>
      <td>979.0</td>
      <td>782.0</td>
      <td>NaN</td>
      <td>512.0</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>NaN</td>
      <td>626.0</td>
      <td>878.0</td>
      <td>980.0</td>
      <td>721.0</td>
      <td>624.0</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903.0</td>
      <td>627.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>601.0</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505.0</td>
      <td>NaN</td>
      <td>669.0</td>
      <td>570.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.A &gt; <span class="number">500</span></span><br></pre></td></tr></table></figure>


    I      False
    II      True
    III    False
    IV     False
    V       True
    VI      True
    Name: A, dtype: bool

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df.A &gt; <span class="number">500</span>]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
* isin方法

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.copy()</span><br><span class="line">df2[<span class="string">&#x27;G&#x27;</span>] = [<span class="string">&#x27;一&#x27;</span>, <span class="string">&#x27;二&#x27;</span>, <span class="string">&#x27;三&#x27;</span>, <span class="string">&#x27;四&#x27;</span>, <span class="string">&#x27;五&#x27;</span>, <span class="string">&#x27;六&#x27;</span>]</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
      <td>一</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
      <td>二</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
      <td>三</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
      <td>四</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
      <td>五</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
      <td>六</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ind = df2[<span class="string">&#x27;G&#x27;</span>].isin([<span class="string">&#x27;一&#x27;</span>, <span class="string">&#x27;五&#x27;</span>])</span><br><span class="line">ind</span><br></pre></td></tr></table></figure>


    I       True
    II     False
    III    False
    IV     False
    V       True
    VI     False
    Name: G, dtype: bool

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[ind]</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
    </tr>
  </tbody>
</table>
## 2.5 赋值

* DataFrame 增加新列

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series(pd.date_range(<span class="string">&#x27;20240101&#x27;</span>, periods=<span class="number">6</span>),</span><br><span class="line">               index=[<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>])</span><br><span class="line">s1</span><br></pre></td></tr></table></figure>


    I     2024-01-01
    II    2024-01-02
    III   2024-01-03
    IV    2024-01-04
    V     2024-01-05
    VI    2024-01-06
    dtype: datetime64[ns]

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;G&#x27;</span>] = s1</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>469</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
* 修改赋值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;A&#x27;</span>] = <span class="number">500</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>500</td>
      <td>135</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">500</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>500</td>
      <td>500</td>
      <td>906</td>
      <td>696</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>984</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>782</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>980</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>138</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>570</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;D&#x27;</span>] = np.array([<span class="number">500</span>]*<span class="built_in">len</span>(df))</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>500</td>
      <td>500</td>
      <td>906</td>
      <td>500</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>II</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>500</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>III</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>500</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>500</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>V</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>500</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>500</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
* 修改index和columns

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.index = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df))]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>500</td>
      <td>500</td>
      <td>906</td>
      <td>500</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>500</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>500</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>500</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>500</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>500</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(df.shape[<span class="number">1</span>])]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>500</td>
      <td>500</td>
      <td>906</td>
      <td>500</td>
      <td>666</td>
      <td>356</td>
      <td>2024-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>823</td>
      <td>763</td>
      <td>205</td>
      <td>500</td>
      <td>149</td>
      <td>846</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>280</td>
      <td>911</td>
      <td>979</td>
      <td>500</td>
      <td>465</td>
      <td>512</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>402</td>
      <td>626</td>
      <td>878</td>
      <td>500</td>
      <td>721</td>
      <td>624</td>
      <td>2024-01-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>903</td>
      <td>627</td>
      <td>331</td>
      <td>500</td>
      <td>334</td>
      <td>601</td>
      <td>2024-01-05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>505</td>
      <td>419</td>
      <td>669</td>
      <td>500</td>
      <td>183</td>
      <td>444</td>
      <td>2024-01-06</td>
    </tr>
  </tbody>
</table>
# 3. 数值运算与统计分析

## 3.1 数据的查看

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randint(<span class="number">100</span>, <span class="number">1000</span> ,size=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">row_labels = [<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>]</span><br><span class="line">col_labels = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">df = pd.DataFrame(data,index=row_labels,columns=col_labels)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>772</td>
      <td>956</td>
      <td>458</td>
      <td>191</td>
      <td>113</td>
      <td>234</td>
    </tr>
    <tr>
      <th>II</th>
      <td>757</td>
      <td>727</td>
      <td>786</td>
      <td>680</td>
      <td>467</td>
      <td>373</td>
    </tr>
    <tr>
      <th>III</th>
      <td>883</td>
      <td>574</td>
      <td>643</td>
      <td>950</td>
      <td>790</td>
      <td>576</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>608</td>
      <td>374</td>
      <td>952</td>
      <td>351</td>
      <td>887</td>
      <td>822</td>
    </tr>
    <tr>
      <th>V</th>
      <td>833</td>
      <td>452</td>
      <td>232</td>
      <td>845</td>
      <td>975</td>
      <td>389</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>243</td>
      <td>781</td>
      <td>613</td>
      <td>957</td>
      <td>734</td>
      <td>744</td>
    </tr>
  </tbody>
</table>
### 3.1.1 查看前面的行

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()      <span class="comment"># 默认五行</span></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>772</td>
      <td>956</td>
      <td>458</td>
      <td>191</td>
      <td>113</td>
      <td>234</td>
    </tr>
    <tr>
      <th>II</th>
      <td>757</td>
      <td>727</td>
      <td>786</td>
      <td>680</td>
      <td>467</td>
      <td>373</td>
    </tr>
    <tr>
      <th>III</th>
      <td>883</td>
      <td>574</td>
      <td>643</td>
      <td>950</td>
      <td>790</td>
      <td>576</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>608</td>
      <td>374</td>
      <td>952</td>
      <td>351</td>
      <td>887</td>
      <td>822</td>
    </tr>
    <tr>
      <th>V</th>
      <td>833</td>
      <td>452</td>
      <td>232</td>
      <td>845</td>
      <td>975</td>
      <td>389</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>772</td>
      <td>956</td>
      <td>458</td>
      <td>191</td>
      <td>113</td>
      <td>234</td>
    </tr>
    <tr>
      <th>II</th>
      <td>757</td>
      <td>727</td>
      <td>786</td>
      <td>680</td>
      <td>467</td>
      <td>373</td>
    </tr>
  </tbody>
</table>
### 3.1.2 查看后面的行

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail()     <span class="comment"># 默认五行</span></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>II</th>
      <td>757</td>
      <td>727</td>
      <td>786</td>
      <td>680</td>
      <td>467</td>
      <td>373</td>
    </tr>
    <tr>
      <th>III</th>
      <td>883</td>
      <td>574</td>
      <td>643</td>
      <td>950</td>
      <td>790</td>
      <td>576</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>608</td>
      <td>374</td>
      <td>952</td>
      <td>351</td>
      <td>887</td>
      <td>822</td>
    </tr>
    <tr>
      <th>V</th>
      <td>833</td>
      <td>452</td>
      <td>232</td>
      <td>845</td>
      <td>975</td>
      <td>389</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>243</td>
      <td>781</td>
      <td>613</td>
      <td>957</td>
      <td>734</td>
      <td>744</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IV</th>
      <td>608</td>
      <td>374</td>
      <td>952</td>
      <td>351</td>
      <td>887</td>
      <td>822</td>
    </tr>
    <tr>
      <th>V</th>
      <td>833</td>
      <td>452</td>
      <td>232</td>
      <td>845</td>
      <td>975</td>
      <td>389</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>243</td>
      <td>781</td>
      <td>613</td>
      <td>957</td>
      <td>734</td>
      <td>744</td>
    </tr>
  </tbody>
</table>
### 3.1.3 查看总体信息

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>, <span class="number">3</span>] = np.nan   <span class="comment"># 将0，3设置成NaN</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>772</td>
      <td>956</td>
      <td>458</td>
      <td>NaN</td>
      <td>113</td>
      <td>234</td>
    </tr>
    <tr>
      <th>II</th>
      <td>757</td>
      <td>727</td>
      <td>786</td>
      <td>680.0</td>
      <td>467</td>
      <td>373</td>
    </tr>
    <tr>
      <th>III</th>
      <td>883</td>
      <td>574</td>
      <td>643</td>
      <td>950.0</td>
      <td>790</td>
      <td>576</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>608</td>
      <td>374</td>
      <td>952</td>
      <td>351.0</td>
      <td>887</td>
      <td>822</td>
    </tr>
    <tr>
      <th>V</th>
      <td>833</td>
      <td>452</td>
      <td>232</td>
      <td>845.0</td>
      <td>975</td>
      <td>389</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>243</td>
      <td>781</td>
      <td>613</td>
      <td>957.0</td>
      <td>734</td>
      <td>744</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>

    <class 'pandas.core.frame.DataFrame'>
    Index: 6 entries, I to VI
    Data columns (total 6 columns):
     #   Column  Non-Null Count  Dtype  
    ---  ------  --------------  -----  
     0   A       6 non-null      int32  
     1   B       6 non-null      int32  
     2   C       6 non-null      int32  
     3   D       5 non-null      float64
     4   E       6 non-null      int32  
     5   F       6 non-null      int32  
    dtypes: float64(1), int32(5)
    memory usage: 216.0+ bytes


## 3.2 Numpy通用函数同样适用于Pandas
### 3.2.1 向量化运算

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = pd.DataFrame(np.arange(<span class="number">4</span>).reshape(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">x</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x + <span class="number">5</span>     <span class="comment"># 广播</span></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.exp(x)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.718282</td>
      <td>7.389056</td>
      <td>20.085537</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = pd.DataFrame(np.arange(<span class="number">4</span>, <span class="number">8</span>).reshape(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">y</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x * y</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>5</td>
      <td>12</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
### 3.2.2 矩阵化运算

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">x = pd.DataFrame(np.random.randint(<span class="number">10</span>, size=(<span class="number">30</span>, <span class="number">30</span>)))</span><br><span class="line">x</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>7</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>8</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>8</td>
      <td>...</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>6</td>
      <td>...</td>
      <td>9</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>6</td>
      <td>5</td>
      <td>7</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>9</td>
      <td>7</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>5</td>
      <td>0</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>9</td>
      <td>...</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
      <td>9</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3</td>
      <td>9</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>...</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>6</td>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>16</th>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>8</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>8</td>
      <td>...</td>
      <td>6</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>2</td>
      <td>6</td>
      <td>8</td>
      <td>9</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>...</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>9</td>
      <td>7</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>...</td>
      <td>3</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>25</th>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>9</td>
      <td>...</td>
      <td>9</td>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>26</th>
      <td>6</td>
      <td>7</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>28</th>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>29</th>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = pd.DataFrame(np.random.randint(<span class="number">10</span>, size=(<span class="number">30</span>, <span class="number">30</span>)))</span><br><span class="line">y</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>9</td>
      <td>3</td>
      <td>8</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>6</td>
      <td>2</td>
      <td>7</td>
      <td>9</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>9</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>...</td>
      <td>9</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>9</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>8</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>7</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>2</td>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
      <td>6</td>
      <td>2</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>...</td>
      <td>8</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>9</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>8</td>
      <td>5</td>
      <td>9</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>8</td>
      <td>5</td>
      <td>...</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>8</td>
      <td>8</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>...</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>7</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>8</td>
      <td>9</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>7</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>9</td>
      <td>6</td>
      <td>6</td>
      <td>...</td>
      <td>6</td>
      <td>2</td>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>7</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>9</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>4</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>5</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>4</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>19</th>
      <td>5</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>8</td>
      <td>2</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>6</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>...</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>22</th>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>24</th>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>25</th>
      <td>5</td>
      <td>9</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>8</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>7</td>
      <td>3</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>9</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>9</td>
      <td>7</td>
      <td>...</td>
      <td>7</td>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>3</td>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>29</th>
      <td>7</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>3</td>
      <td>9</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z = x.T</span><br><span class="line">z</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>6</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>8</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>9</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>...</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>...</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7</td>
      <td>1</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>9</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>7</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>5</td>
      <td>...</td>
      <td>9</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2</td>
      <td>8</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5</td>
      <td>9</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>9</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>7</td>
      <td>...</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>9</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>9</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>17</th>
      <td>7</td>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
      <td>7</td>
    </tr>
    <tr>
      <th>20</th>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>2</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>9</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>6</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>9</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>8</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
      <td>6</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>28</th>
      <td>6</td>
      <td>5</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>29</th>
      <td>3</td>
      <td>9</td>
      <td>2</td>
      <td>8</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
* 执行相同操作，Numpy与Pandas的对比

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit x.dot(y)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">257 μs ± 90.9 μs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x, y)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">66.4 μs ± 2.34 μs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x1 = np.array(x)</span><br><span class="line">x1</span><br></pre></td></tr></table></figure>


    array([[6, 3, 7, 4, 6, 9, 2, 6, 7, 4, 3, 7, 7, 2, 5, 4, 1, 7, 5, 1, 4, 0,
            9, 5, 8, 0, 9, 2, 6, 3],
           [8, 2, 4, 2, 6, 4, 8, 6, 1, 3, 8, 1, 9, 8, 9, 4, 1, 3, 6, 7, 2, 0,
            3, 1, 7, 3, 1, 5, 5, 9],
           [3, 5, 1, 9, 1, 9, 3, 7, 6, 8, 7, 4, 1, 4, 7, 9, 8, 8, 0, 8, 6, 8,
            7, 0, 7, 7, 2, 0, 7, 2],
           [2, 0, 4, 9, 6, 9, 8, 6, 8, 7, 1, 0, 6, 6, 7, 4, 2, 7, 5, 2, 0, 2,
            4, 2, 0, 4, 9, 6, 6, 8],
           [9, 9, 2, 6, 0, 3, 3, 4, 6, 6, 3, 6, 2, 5, 1, 9, 8, 4, 5, 3, 9, 6,
            8, 6, 0, 0, 8, 8, 3, 8],
           [2, 6, 5, 7, 8, 4, 0, 2, 9, 7, 5, 7, 8, 3, 0, 0, 9, 3, 6, 1, 2, 0,
            4, 0, 7, 0, 0, 1, 1, 5],
           [6, 4, 0, 0, 2, 1, 4, 9, 5, 6, 3, 6, 7, 0, 5, 7, 4, 3, 1, 5, 5, 0,
            8, 5, 2, 3, 3, 2, 9, 2],
           [2, 3, 6, 3, 8, 0, 7, 6, 1, 7, 0, 8, 8, 1, 6, 9, 2, 6, 9, 8, 3, 0,
            1, 0, 4, 4, 6, 8, 8, 2],
           [2, 2, 3, 7, 5, 7, 0, 7, 3, 0, 7, 3, 5, 7, 3, 2, 8, 2, 8, 1, 1, 1,
            5, 2, 8, 3, 0, 3, 0, 4],
           [3, 7, 7, 6, 2, 0, 0, 2, 5, 6, 5, 5, 5, 2, 5, 7, 1, 4, 0, 0, 4, 2,
            3, 2, 0, 0, 4, 5, 2, 8],
           [4, 7, 0, 4, 2, 0, 3, 4, 6, 0, 2, 1, 8, 9, 5, 9, 2, 7, 7, 1, 5, 6,
            1, 9, 1, 9, 0, 7, 0, 8],
           [5, 6, 9, 6, 9, 2, 1, 8, 7, 9, 6, 8, 3, 3, 0, 7, 2, 6, 1, 1, 6, 5,
            2, 8, 9, 5, 9, 9, 5, 0],
           [3, 9, 5, 5, 4, 0, 7, 4, 4, 6, 3, 5, 3, 2, 6, 7, 3, 1, 9, 2, 0, 7,
            2, 9, 6, 9, 4, 9, 4, 6],
           [8, 4, 0, 9, 9, 0, 1, 5, 8, 7, 4, 0, 6, 4, 5, 6, 2, 9, 2, 4, 5, 8,
            4, 0, 3, 4, 9, 9, 4, 6],
           [3, 0, 4, 6, 9, 9, 5, 4, 3, 1, 3, 9, 9, 2, 9, 0, 7, 4, 3, 7, 6, 1,
            0, 3, 7, 1, 2, 0, 0, 2],
           [4, 2, 0, 0, 7, 9, 1, 2, 1, 2, 6, 0, 9, 7, 9, 9, 9, 1, 2, 8, 6, 3,
            9, 4, 1, 7, 3, 8, 4, 8],
           [3, 9, 4, 8, 7, 2, 0, 2, 3, 1, 0, 6, 7, 6, 4, 0, 6, 6, 8, 2, 8, 0,
            0, 3, 8, 5, 2, 0, 3, 8],
           [2, 8, 6, 3, 2, 9, 4, 4, 2, 8, 3, 4, 3, 4, 6, 8, 6, 4, 9, 9, 6, 9,
            4, 2, 6, 1, 8, 9, 9, 0],
           [5, 6, 7, 9, 8, 1, 9, 1, 4, 4, 5, 2, 7, 0, 5, 3, 0, 6, 8, 3, 3, 5,
            2, 5, 6, 9, 9, 2, 6, 2],
           [1, 9, 3, 7, 8, 6, 0, 2, 8, 0, 8, 7, 0, 5, 4, 5, 9, 4, 5, 4, 4, 3,
            2, 2, 3, 8, 1, 8, 0, 0],
           [4, 5, 5, 2, 6, 8, 9, 7, 5, 7, 4, 7, 9, 3, 9, 7, 9, 1, 4, 8, 3, 5,
            0, 8, 0, 4, 3, 2, 5, 1],
           [2, 4, 8, 1, 9, 7, 1, 4, 6, 7, 0, 5, 0, 1, 0, 4, 9, 8, 5, 0, 0, 1,
            8, 2, 0, 4, 6, 5, 0, 4],
           [4, 5, 2, 4, 6, 4, 4, 4, 9, 9, 2, 0, 4, 8, 0, 2, 3, 0, 0, 7, 1, 7,
            6, 9, 9, 1, 5, 5, 2, 1],
           [0, 5, 4, 8, 0, 6, 4, 4, 1, 2, 6, 5, 1, 5, 1, 1, 1, 2, 1, 3, 8, 5,
            0, 7, 6, 9, 2, 0, 4, 3],
           [9, 7, 0, 9, 0, 3, 7, 4, 1, 5, 4, 1, 2, 8, 6, 6, 5, 7, 3, 7, 3, 7,
            8, 2, 2, 1, 9, 2, 2, 4],
           [4, 1, 9, 5, 4, 5, 0, 4, 8, 9, 1, 0, 9, 8, 9, 8, 8, 5, 7, 0, 9, 3,
            0, 7, 0, 2, 3, 7, 5, 9],
           [6, 7, 1, 9, 7, 2, 6, 2, 6, 1, 9, 5, 2, 2, 8, 6, 4, 9, 6, 8, 0, 6,
            5, 9, 8, 0, 3, 8, 3, 9],
           [2, 8, 1, 3, 5, 1, 7, 7, 0, 2, 9, 8, 4, 5, 3, 9, 1, 7, 5, 4, 8, 0,
            4, 5, 4, 5, 5, 6, 3, 7],
           [6, 8, 6, 2, 2, 7, 4, 3, 7, 5, 1, 3, 3, 5, 5, 0, 7, 5, 2, 8, 1, 7,
            9, 2, 4, 5, 9, 5, 3, 2],
           [3, 0, 3, 0, 0, 9, 5, 4, 3, 2, 0, 5, 1, 7, 9, 4, 6, 9, 1, 7, 1, 3,
            0, 4, 8, 0, 8, 7, 5, 6]])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y1 = np.array(y)</span><br><span class="line">y1</span><br></pre></td></tr></table></figure>


    array([[2, 0, 4, 1, 4, 7, 8, 1, 2, 2, 0, 7, 5, 7, 8, 4, 2, 4, 4, 4, 2, 9,
            3, 8, 9, 8, 1, 7, 7, 6],
           [7, 2, 5, 0, 6, 0, 8, 0, 0, 6, 1, 4, 7, 7, 2, 6, 2, 5, 5, 2, 6, 2,
            7, 9, 3, 0, 3, 6, 3, 5],
           [8, 0, 4, 6, 0, 3, 5, 1, 9, 4, 9, 0, 5, 5, 3, 7, 3, 7, 7, 4, 3, 1,
            2, 2, 3, 3, 9, 4, 3, 9],
           [7, 5, 5, 7, 6, 9, 9, 7, 1, 8, 0, 7, 3, 3, 4, 7, 4, 7, 9, 0, 9, 8,
            5, 2, 7, 8, 5, 6, 0, 4],
           [4, 9, 3, 5, 6, 8, 0, 5, 6, 2, 7, 4, 8, 4, 8, 9, 3, 8, 4, 9, 8, 2,
            3, 8, 9, 5, 1, 6, 1, 1],
           [0, 2, 5, 7, 8, 6, 3, 5, 4, 7, 0, 0, 5, 9, 1, 4, 0, 6, 0, 3, 8, 0,
            3, 5, 5, 7, 0, 6, 0, 6],
           [2, 7, 2, 0, 7, 2, 1, 0, 2, 1, 1, 5, 0, 1, 5, 2, 3, 0, 7, 6, 6, 2,
            9, 9, 2, 1, 0, 6, 6, 1],
           [6, 7, 0, 8, 6, 2, 7, 6, 7, 5, 8, 4, 2, 2, 0, 7, 1, 2, 7, 7, 3, 3,
            4, 5, 4, 6, 1, 6, 9, 6],
           [0, 6, 4, 2, 2, 3, 1, 1, 0, 4, 3, 9, 1, 2, 6, 6, 3, 4, 4, 5, 8, 1,
            4, 2, 3, 9, 5, 7, 0, 9],
           [7, 6, 0, 1, 2, 0, 8, 7, 1, 8, 6, 8, 5, 5, 3, 9, 9, 1, 6, 4, 5, 1,
            4, 9, 3, 8, 5, 1, 0, 4],
           [8, 5, 9, 6, 4, 9, 5, 4, 8, 5, 7, 1, 8, 4, 6, 9, 0, 9, 4, 9, 1, 5,
            0, 2, 4, 3, 2, 9, 4, 7],
           [3, 0, 6, 7, 2, 5, 1, 6, 7, 5, 5, 4, 7, 0, 9, 3, 3, 2, 2, 3, 0, 1,
            8, 9, 1, 4, 8, 8, 7, 0],
           [0, 8, 7, 9, 8, 6, 2, 2, 1, 4, 2, 5, 1, 2, 4, 0, 0, 9, 8, 6, 0, 7,
            2, 7, 4, 0, 6, 4, 5, 5],
           [7, 8, 1, 8, 9, 8, 9, 9, 6, 0, 6, 9, 4, 5, 9, 6, 4, 6, 8, 2, 7, 1,
            6, 1, 3, 6, 2, 1, 9, 6],
           [0, 7, 2, 1, 2, 4, 7, 9, 6, 6, 6, 7, 0, 3, 5, 8, 1, 0, 9, 1, 6, 2,
            9, 1, 6, 1, 2, 6, 3, 0],
           [4, 8, 7, 8, 9, 8, 6, 3, 4, 0, 0, 2, 7, 1, 3, 1, 4, 8, 0, 4, 8, 0,
            8, 7, 3, 9, 4, 4, 5, 6],
           [7, 7, 1, 8, 6, 3, 3, 7, 3, 5, 4, 2, 9, 1, 8, 9, 8, 0, 9, 2, 7, 5,
            4, 4, 5, 6, 0, 8, 2, 3],
           [9, 0, 9, 2, 1, 1, 0, 7, 2, 2, 5, 7, 8, 8, 3, 4, 1, 8, 7, 2, 8, 2,
            8, 1, 9, 8, 7, 8, 4, 1],
           [7, 5, 7, 4, 9, 1, 5, 4, 4, 0, 1, 7, 2, 9, 2, 7, 7, 1, 7, 0, 5, 7,
            2, 7, 0, 8, 8, 4, 9, 3],
           [5, 6, 4, 9, 8, 2, 6, 9, 9, 4, 6, 1, 3, 1, 6, 1, 0, 8, 0, 7, 1, 7,
            2, 5, 2, 6, 9, 8, 1, 4],
           [5, 3, 3, 3, 1, 3, 0, 5, 0, 9, 5, 0, 5, 9, 7, 1, 1, 3, 2, 3, 6, 0,
            5, 2, 9, 6, 9, 1, 1, 3],
           [0, 2, 8, 6, 6, 3, 1, 3, 5, 2, 0, 7, 4, 4, 3, 5, 2, 8, 4, 2, 0, 9,
            5, 1, 2, 0, 8, 7, 1, 7],
           [8, 0, 4, 7, 1, 3, 6, 2, 4, 7, 9, 2, 3, 8, 6, 0, 3, 3, 8, 5, 8, 5,
            5, 4, 4, 1, 7, 7, 0, 7],
           [4, 1, 1, 5, 8, 0, 5, 8, 7, 5, 2, 7, 8, 0, 8, 5, 5, 3, 0, 9, 7, 1,
            0, 1, 0, 0, 8, 0, 3, 9],
           [5, 6, 1, 5, 6, 9, 9, 1, 1, 9, 6, 0, 7, 2, 5, 8, 5, 8, 6, 8, 1, 7,
            7, 1, 3, 6, 3, 3, 5, 9],
           [5, 9, 2, 8, 9, 1, 5, 6, 8, 2, 9, 2, 6, 3, 7, 6, 4, 6, 2, 1, 5, 1,
            2, 5, 4, 7, 8, 2, 9, 2],
           [2, 5, 0, 6, 0, 4, 9, 7, 3, 4, 3, 3, 7, 1, 0, 2, 8, 3, 9, 4, 1, 3,
            1, 1, 3, 5, 6, 9, 2, 2],
           [9, 5, 2, 1, 7, 4, 0, 2, 9, 7, 3, 6, 9, 1, 6, 4, 4, 5, 8, 5, 7, 6,
            8, 3, 1, 6, 5, 0, 8, 8],
           [1, 2, 4, 4, 0, 7, 7, 3, 6, 9, 2, 5, 9, 9, 8, 0, 4, 3, 7, 0, 8, 5,
            3, 8, 4, 4, 4, 0, 0, 7],
           [7, 5, 3, 1, 1, 8, 4, 3, 9, 0, 6, 2, 5, 4, 4, 4, 0, 0, 2, 9, 3, 4,
            1, 7, 1, 8, 1, 8, 6, 7]])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit x1.dot(y1)</span><br></pre></td></tr></table></figure>

    16.9 μs ± 294 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x1,y1)</span><br></pre></td></tr></table></figure>


    19.4 μs ± 6.07 μs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x.values, y.values)</span><br></pre></td></tr></table></figure>


    23.3 μs ± 4.72 μs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)


一般来说，纯粹的计算在Numpy里执行更快。

Numpy更侧重于计算，Pandas更侧重于数据处理。

至于用python列表实现矩阵乘法，和这两个不是一个数量级的。

### 3.2.3 广播运算

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randint(<span class="number">100</span>, <span class="number">1000</span> ,size=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">row_labels = [<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>]</span><br><span class="line">col_labels = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">df = pd.DataFrame(data,index=row_labels,columns=col_labels)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>594</td>
      <td>526</td>
      <td>277</td>
      <td>527</td>
      <td>393</td>
      <td>951</td>
    </tr>
    <tr>
      <th>II</th>
      <td>250</td>
      <td>483</td>
      <td>737</td>
      <td>912</td>
      <td>407</td>
      <td>435</td>
    </tr>
    <tr>
      <th>III</th>
      <td>845</td>
      <td>991</td>
      <td>474</td>
      <td>107</td>
      <td>440</td>
      <td>228</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>875</td>
      <td>768</td>
      <td>451</td>
      <td>457</td>
      <td>616</td>
      <td>594</td>
    </tr>
    <tr>
      <th>V</th>
      <td>185</td>
      <td>274</td>
      <td>901</td>
      <td>292</td>
      <td>410</td>
      <td>218</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>317</td>
      <td>526</td>
      <td>513</td>
      <td>213</td>
      <td>244</td>
      <td>637</td>
    </tr>
  </tbody>
</table>


* 按行广播

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>


    A    594
    B    526
    C    277
    D    527
    E    393
    F    951
    Name: I, dtype: int32


<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df/df.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>II</th>
      <td>0.420875</td>
      <td>0.918251</td>
      <td>2.660650</td>
      <td>1.730550</td>
      <td>1.035623</td>
      <td>0.457413</td>
    </tr>
    <tr>
      <th>III</th>
      <td>1.422559</td>
      <td>1.884030</td>
      <td>1.711191</td>
      <td>0.203036</td>
      <td>1.119593</td>
      <td>0.239748</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>1.473064</td>
      <td>1.460076</td>
      <td>1.628159</td>
      <td>0.867173</td>
      <td>1.567430</td>
      <td>0.624606</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.311448</td>
      <td>0.520913</td>
      <td>3.252708</td>
      <td>0.554080</td>
      <td>1.043257</td>
      <td>0.229232</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>0.533670</td>
      <td>1.000000</td>
      <td>1.851986</td>
      <td>0.404175</td>
      <td>0.620865</td>
      <td>0.669821</td>
    </tr>
  </tbody>
</table>




* 按列广播

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.A</span><br></pre></td></tr></table></figure>


    I      594
    II     250
    III    845
    IV     875
    V      185
    VI     317
    Name: A, dtype: int32


<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.div(df.A, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>1.0</td>
      <td>0.885522</td>
      <td>0.466330</td>
      <td>0.887205</td>
      <td>0.661616</td>
      <td>1.601010</td>
    </tr>
    <tr>
      <th>II</th>
      <td>1.0</td>
      <td>1.932000</td>
      <td>2.948000</td>
      <td>3.648000</td>
      <td>1.628000</td>
      <td>1.740000</td>
    </tr>
    <tr>
      <th>III</th>
      <td>1.0</td>
      <td>1.172781</td>
      <td>0.560947</td>
      <td>0.126627</td>
      <td>0.520710</td>
      <td>0.269822</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>1.0</td>
      <td>0.877714</td>
      <td>0.515429</td>
      <td>0.522286</td>
      <td>0.704000</td>
      <td>0.678857</td>
    </tr>
    <tr>
      <th>V</th>
      <td>1.0</td>
      <td>1.481081</td>
      <td>4.870270</td>
      <td>1.578378</td>
      <td>2.216216</td>
      <td>1.178378</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>1.0</td>
      <td>1.659306</td>
      <td>1.618297</td>
      <td>0.671924</td>
      <td>0.769716</td>
      <td>2.009464</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.div(df.iloc[<span class="number">0</span>], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>II</th>
      <td>0.420875</td>
      <td>0.918251</td>
      <td>2.660650</td>
      <td>1.730550</td>
      <td>1.035623</td>
      <td>0.457413</td>
    </tr>
    <tr>
      <th>III</th>
      <td>1.422559</td>
      <td>1.884030</td>
      <td>1.711191</td>
      <td>0.203036</td>
      <td>1.119593</td>
      <td>0.239748</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>1.473064</td>
      <td>1.460076</td>
      <td>1.628159</td>
      <td>0.867173</td>
      <td>1.567430</td>
      <td>0.624606</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.311448</td>
      <td>0.520913</td>
      <td>3.252708</td>
      <td>0.554080</td>
      <td>1.043257</td>
      <td>0.229232</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>0.533670</td>
      <td>1.000000</td>
      <td>1.851986</td>
      <td>0.404175</td>
      <td>0.620865</td>
      <td>0.669821</td>
    </tr>
  </tbody>
</table>
## 3.3 新的用法

### 3.3.1 索引对齐

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A = pd.DataFrame(np.random.randint(<span class="number">0</span>, <span class="number">20</span>, size=(<span class="number">2</span>, <span class="number">2</span>)), columns=<span class="built_in">list</span>(<span class="string">&#x27;AB&#x27;</span>))</span><br><span class="line">A</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>16</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">B = pd.DataFrame(np.random.randint(<span class="number">0</span>, <span class="number">20</span>, size=(<span class="number">3</span>, <span class="number">3</span>)), columns=<span class="built_in">list</span>(<span class="string">&#x27;ABC&#x27;</span>))</span><br><span class="line">B</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>7</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18</td>
      <td>15</td>
      <td>13</td>
    </tr>
  </tbody>
</table>


* pandas会自动对其两个对象的索引，没有的值用np.nan表示

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A+B</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>16.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>


* 缺省值也可以用fill_value来填充

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.add(B, fill_value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>21.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>16.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>15.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A*B</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77.0</td>
      <td>98.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


### 3.3.2 统计相关

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = np.random.randint(<span class="number">3</span>, size=<span class="number">20</span>)</span><br><span class="line">y</span><br></pre></td></tr></table></figure>


    array([0, 0, 0, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 2])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.unique(y)</span><br></pre></td></tr></table></figure>


    array([0, 1, 2])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">Counter(y)</span><br></pre></td></tr></table></figure>


    Counter({0: 12, 1: 5, 2: 3})

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y1 = pd.DataFrame(y, columns=[<span class="string">&#x27;A&#x27;</span>])</span><br><span class="line">y1</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.unique(y1)</span><br></pre></td></tr></table></figure>


    array([0, 1, 2])

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y1[<span class="string">&#x27;A&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>


    A
    0    12
    1     5
    2     3
    Name: count, dtype: int64

* 产生新的结果，并进行排除

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">&#x27;BeiJing&#x27;</span>: <span class="number">2189</span>,</span><br><span class="line">                  <span class="string">&#x27;ShangHai&#x27;</span>: <span class="number">2487</span>,</span><br><span class="line">                  <span class="string">&#x27;GuangZhou&#x27;</span>: <span class="number">1867</span>,</span><br><span class="line">                  <span class="string">&#x27;ShenZhen&#x27;</span>:<span class="number">1756</span>&#125;</span><br><span class="line">population = pd.Series(population_dict)</span><br><span class="line"></span><br><span class="line">GDP_dict = &#123;<span class="string">&#x27;BeiJing&#x27;</span>: <span class="number">36102</span>,</span><br><span class="line">             <span class="string">&#x27;ShangHai&#x27;</span>: <span class="number">38700</span>,</span><br><span class="line">             <span class="string">&#x27;GuangZhou&#x27;</span>: <span class="number">25019</span>,</span><br><span class="line">             <span class="string">&#x27;ShenZhen&#x27;</span>:<span class="number">27670</span>&#125;</span><br><span class="line">GDP = pd.Series(GDP_dict)</span><br><span class="line"></span><br><span class="line">city_info = pd.DataFrame(&#123;<span class="string">&#x27;population&#x27;</span>:population,<span class="string">&#x27;GDP&#x27;</span>:GDP&#125;)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info[<span class="string">&#x27;per_GDP&#x27;</span>] = city_info[<span class="string">&#x27;GDP&#x27;</span>]/city_info[<span class="string">&#x27;population&#x27;</span>]</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>16.492462</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>15.560917</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>13.400643</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>15.757403</td>
    </tr>
  </tbody>
</table>
</div>



* 递增排序

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">city_info.sort_values(by=<span class="string">&#x27;per_GDP&#x27;</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>13.400643</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>15.560917</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>15.757403</td>
    </tr>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>16.492462</td>
    </tr>
  </tbody>
</table>
</div>

* 递减排序

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">city_info.sort_values(by=<span class="string">&#x27;per_GDP&#x27;</span>, ascending=<span class="literal">False</span>) </span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2189</td>
      <td>36102</td>
      <td>16.492462</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1756</td>
      <td>27670</td>
      <td>15.757403</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2487</td>
      <td>38700</td>
      <td>15.560917</td>
    </tr>
    <tr>
      <th>GuangZhou</th>
      <td>1867</td>
      <td>25019</td>
      <td>13.400643</td>
    </tr>
  </tbody>
</table>




* 按轴进行排序

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.random.randint(<span class="number">20</span>, size=(<span class="number">3</span>, <span class="number">4</span>)), index=[<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">                   columns=<span class="built_in">list</span>(<span class="string">&quot;ABCD&quot;</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>5</td>
      <td>18</td>
      <td>5</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>17</td>
      <td>12</td>
      <td>8</td>
    </tr>
  </tbody>
</table>




* 行排序

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index()</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>17</td>
      <td>12</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>5</td>
      <td>18</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>13</td>
    </tr>
  </tbody>
</table>




* 列排序

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>5</td>
      <td>18</td>
      <td>5</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>17</td>
      <td>12</td>
      <td>8</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index(axis=<span class="number">1</span>,ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>18</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>12</td>
      <td>17</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



* 统计方法

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randint(<span class="number">100</span>, <span class="number">1000</span> ,size=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">row_labels = [<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>]</span><br><span class="line">col_labels = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">df = pd.DataFrame(data,index=row_labels,columns=col_labels)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>378</td>
      <td>950</td>
      <td>464</td>
      <td>430</td>
      <td>740</td>
      <td>443</td>
    </tr>
    <tr>
      <th>II</th>
      <td>921</td>
      <td>554</td>
      <td>700</td>
      <td>824</td>
      <td>754</td>
      <td>164</td>
    </tr>
    <tr>
      <th>III</th>
      <td>175</td>
      <td>810</td>
      <td>242</td>
      <td>927</td>
      <td>704</td>
      <td>572</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>516</td>
      <td>404</td>
      <td>835</td>
      <td>596</td>
      <td>390</td>
      <td>201</td>
    </tr>
    <tr>
      <th>V</th>
      <td>366</td>
      <td>966</td>
      <td>721</td>
      <td>941</td>
      <td>876</td>
      <td>102</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>184</td>
      <td>893</td>
      <td>427</td>
      <td>915</td>
      <td>549</td>
      <td>553</td>
    </tr>
  </tbody>
</table>
</div>



* 非空个数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.count()</span><br></pre></td></tr></table></figure>


    A    6
    B    6
    C    6
    D    6
    E    6
    F    6
    dtype: int64



* 对每一列求和

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>


    A    2540
    B    4577
    C    3389
    D    4633
    E    4013
    F    2035
    dtype: int64



* 对每一行求和

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>


    I      3405
    II     3917
    III    3430
    IV     2942
    V      3972
    VI     3521
    dtype: int64



* 最大值和最小值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.<span class="built_in">min</span>()</span><br></pre></td></tr></table></figure>


    A    175
    B    404
    C    242
    D    430
    E    390
    F    102
    dtype: int32

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.<span class="built_in">max</span>()</span><br></pre></td></tr></table></figure>


    A    921
    B    966
    C    835
    D    941
    E    876
    F    572
    dtype: int32

* 最大值坐标

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>378</td>
      <td>950</td>
      <td>464</td>
      <td>430</td>
      <td>740</td>
      <td>443</td>
    </tr>
    <tr>
      <th>II</th>
      <td>921</td>
      <td>554</td>
      <td>700</td>
      <td>824</td>
      <td>754</td>
      <td>164</td>
    </tr>
    <tr>
      <th>III</th>
      <td>175</td>
      <td>810</td>
      <td>242</td>
      <td>927</td>
      <td>704</td>
      <td>572</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>516</td>
      <td>404</td>
      <td>835</td>
      <td>596</td>
      <td>390</td>
      <td>201</td>
    </tr>
    <tr>
      <th>V</th>
      <td>366</td>
      <td>966</td>
      <td>721</td>
      <td>941</td>
      <td>876</td>
      <td>102</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>184</td>
      <td>893</td>
      <td>427</td>
      <td>915</td>
      <td>549</td>
      <td>553</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.idxmax()</span><br></pre></td></tr></table></figure>


    A     II
    B      V
    C     IV
    D      V
    E      V
    F    III
    dtype: object

* 均值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean()</span><br></pre></td></tr></table></figure>


    A    423.333333
    B    762.833333
    C    564.833333
    D    772.166667
    E    668.833333
    F    339.166667
    dtype: float64

* 方差

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.var()</span><br></pre></td></tr></table></figure>


    A    76110.266667
    B    53569.766667
    C    49806.966667
    D    44735.766667
    E    29716.166667
    F    43347.766667
    dtype: float64

* 标准差

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.std()</span><br></pre></td></tr></table></figure>


    A    275.880892
    B    231.451435
    C    223.174745
    D    211.508313
    E    172.383777
    F    208.201265
    dtype: float64

* 中位数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.median()</span><br></pre></td></tr></table></figure>


    A    372.0
    B    851.5
    C    582.0
    D    869.5
    E    722.0
    F    322.0
    dtype: float64

* 众数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mode()</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>175</td>
      <td>404</td>
      <td>242</td>
      <td>430</td>
      <td>390</td>
      <td>102</td>
    </tr>
    <tr>
      <th>1</th>
      <td>184</td>
      <td>554</td>
      <td>427</td>
      <td>596</td>
      <td>549</td>
      <td>164</td>
    </tr>
    <tr>
      <th>2</th>
      <td>366</td>
      <td>810</td>
      <td>464</td>
      <td>824</td>
      <td>704</td>
      <td>201</td>
    </tr>
    <tr>
      <th>3</th>
      <td>378</td>
      <td>893</td>
      <td>700</td>
      <td>915</td>
      <td>740</td>
      <td>443</td>
    </tr>
    <tr>
      <th>4</th>
      <td>516</td>
      <td>950</td>
      <td>721</td>
      <td>927</td>
      <td>754</td>
      <td>553</td>
    </tr>
    <tr>
      <th>5</th>
      <td>921</td>
      <td>966</td>
      <td>835</td>
      <td>941</td>
      <td>876</td>
      <td>572</td>
    </tr>
  </tbody>
</table>




* 75%分位数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.quantile(<span class="number">0.75</span>)</span><br></pre></td></tr></table></figure>


    A    481.50
    B    935.75
    C    715.75
    D    924.00
    E    750.50
    F    525.50
    Name: 0.75, dtype: float64



* 各种统计数据

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>423.333333</td>
      <td>762.833333</td>
      <td>564.833333</td>
      <td>772.166667</td>
      <td>668.833333</td>
      <td>339.166667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>275.880892</td>
      <td>231.451435</td>
      <td>223.174745</td>
      <td>211.508313</td>
      <td>172.383777</td>
      <td>208.201265</td>
    </tr>
    <tr>
      <th>min</th>
      <td>175.000000</td>
      <td>404.000000</td>
      <td>242.000000</td>
      <td>430.000000</td>
      <td>390.000000</td>
      <td>102.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>229.500000</td>
      <td>618.000000</td>
      <td>436.250000</td>
      <td>653.000000</td>
      <td>587.750000</td>
      <td>173.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>372.000000</td>
      <td>851.500000</td>
      <td>582.000000</td>
      <td>869.500000</td>
      <td>722.000000</td>
      <td>322.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>481.500000</td>
      <td>935.750000</td>
      <td>715.750000</td>
      <td>924.000000</td>
      <td>750.500000</td>
      <td>525.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>921.000000</td>
      <td>966.000000</td>
      <td>835.000000</td>
      <td>941.000000</td>
      <td>876.000000</td>
      <td>572.000000</td>
    </tr>
  </tbody>
</table>




* 相关性系数和协方差

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.corr()   <span class="comment"># 只看abcd与其中某一列的相关系数</span></span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.000000</td>
      <td>-0.627004</td>
      <td>0.653177</td>
      <td>-0.196508</td>
      <td>0.089952</td>
      <td>-0.696691</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.627004</td>
      <td>1.000000</td>
      <td>-0.563305</td>
      <td>0.198326</td>
      <td>0.620269</td>
      <td>0.399370</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.653177</td>
      <td>-0.563305</td>
      <td>1.000000</td>
      <td>-0.209277</td>
      <td>-0.174046</td>
      <td>-0.917467</td>
    </tr>
    <tr>
      <th>D</th>
      <td>-0.196508</td>
      <td>0.198326</td>
      <td>-0.209277</td>
      <td>1.000000</td>
      <td>0.287928</td>
      <td>0.028539</td>
    </tr>
    <tr>
      <th>E</th>
      <td>0.089952</td>
      <td>0.620269</td>
      <td>-0.174046</td>
      <td>0.287928</td>
      <td>1.000000</td>
      <td>-0.198230</td>
    </tr>
    <tr>
      <th>F</th>
      <td>-0.696691</td>
      <td>0.399370</td>
      <td>-0.917467</td>
      <td>0.028539</td>
      <td>-0.198230</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.corrwith(df[<span class="string">&#x27;A&#x27;</span>])</span><br></pre></td></tr></table></figure>


    A    1.000000
    B   -0.627004
    C    0.653177
    D   -0.196508
    E    0.089952
    F   -0.696691
    dtype: float64



* 自定义输出

apply(method)的用法：使用method方法默认对每一列进行相应的操作

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>378</td>
      <td>950</td>
      <td>464</td>
      <td>430</td>
      <td>740</td>
      <td>443</td>
    </tr>
    <tr>
      <th>II</th>
      <td>921</td>
      <td>554</td>
      <td>700</td>
      <td>824</td>
      <td>754</td>
      <td>164</td>
    </tr>
    <tr>
      <th>III</th>
      <td>175</td>
      <td>810</td>
      <td>242</td>
      <td>927</td>
      <td>704</td>
      <td>572</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>516</td>
      <td>404</td>
      <td>835</td>
      <td>596</td>
      <td>390</td>
      <td>201</td>
    </tr>
    <tr>
      <th>V</th>
      <td>366</td>
      <td>966</td>
      <td>721</td>
      <td>941</td>
      <td>876</td>
      <td>102</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>184</td>
      <td>893</td>
      <td>427</td>
      <td>915</td>
      <td>549</td>
      <td>553</td>
    </tr>
  </tbody>
</table>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.cumsum)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>378</td>
      <td>950</td>
      <td>464</td>
      <td>430</td>
      <td>740</td>
      <td>443</td>
    </tr>
    <tr>
      <th>II</th>
      <td>1299</td>
      <td>1504</td>
      <td>1164</td>
      <td>1254</td>
      <td>1494</td>
      <td>607</td>
    </tr>
    <tr>
      <th>III</th>
      <td>1474</td>
      <td>2314</td>
      <td>1406</td>
      <td>2181</td>
      <td>2198</td>
      <td>1179</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>1990</td>
      <td>2718</td>
      <td>2241</td>
      <td>2777</td>
      <td>2588</td>
      <td>1380</td>
    </tr>
    <tr>
      <th>V</th>
      <td>2356</td>
      <td>3684</td>
      <td>2962</td>
      <td>3718</td>
      <td>3464</td>
      <td>1482</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>2540</td>
      <td>4577</td>
      <td>3389</td>
      <td>4633</td>
      <td>4013</td>
      <td>2035</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.cumsum, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>378</td>
      <td>1328</td>
      <td>1792</td>
      <td>2222</td>
      <td>2962</td>
      <td>3405</td>
    </tr>
    <tr>
      <th>II</th>
      <td>921</td>
      <td>1475</td>
      <td>2175</td>
      <td>2999</td>
      <td>3753</td>
      <td>3917</td>
    </tr>
    <tr>
      <th>III</th>
      <td>175</td>
      <td>985</td>
      <td>1227</td>
      <td>2154</td>
      <td>2858</td>
      <td>3430</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>516</td>
      <td>920</td>
      <td>1755</td>
      <td>2351</td>
      <td>2741</td>
      <td>2942</td>
    </tr>
    <tr>
      <th>V</th>
      <td>366</td>
      <td>1332</td>
      <td>2053</td>
      <td>2994</td>
      <td>3870</td>
      <td>3972</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>184</td>
      <td>1077</td>
      <td>1504</td>
      <td>2419</td>
      <td>2968</td>
      <td>3521</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>


    A    2540
    B    4577
    C    3389
    D    4633
    E    4013
    F    2035
    dtype: int64

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(<span class="keyword">lambda</span> x: x.<span class="built_in">max</span>()-x.<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure>


    A    746
    B    562
    C    593
    D    511
    E    486
    F    470
    dtype: int64

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_describe</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> pd.Series([x.count(), x.mean(), x.<span class="built_in">max</span>(), x.idxmin(), x.std()],\</span><br><span class="line">                    index=[<span class="string">&#x27;Count&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;idxmin&#x27;</span>, <span class="string">&#x27;std&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df.apply(my_describe)</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Count</th>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>423.333333</td>
      <td>762.833333</td>
      <td>564.833333</td>
      <td>772.166667</td>
      <td>668.833333</td>
      <td>339.166667</td>
    </tr>
    <tr>
      <th>max</th>
      <td>921</td>
      <td>966</td>
      <td>835</td>
      <td>941</td>
      <td>876</td>
      <td>572</td>
    </tr>
    <tr>
      <th>idxmin</th>
      <td>III</td>
      <td>IV</td>
      <td>III</td>
      <td>I</td>
      <td>IV</td>
      <td>V</td>
    </tr>
    <tr>
      <th>std</th>
      <td>275.880892</td>
      <td>231.451435</td>
      <td>223.174745</td>
      <td>211.508313</td>
      <td>172.383777</td>
      <td>208.201265</td>
    </tr>
  </tbody>
</table>




* 字符串

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机字符串的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_string</span>(<span class="params">length=<span class="number">1</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;生成指定长度的随机字符串&quot;&quot;&quot;</span></span><br><span class="line">    letters = string.ascii_uppercase  <span class="comment"># 仅使用大写字母</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choice(letters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line"></span><br><span class="line">rows = [<span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>]</span><br><span class="line">columns = [<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]  <span class="comment"># 生成 A 到 F</span></span><br><span class="line">data = [[random_string() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">df = pd.DataFrame(data, index=rows, columns=columns)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>V</td>
      <td>Y</td>
      <td>B</td>
      <td>G</td>
      <td>X</td>
      <td>H</td>
    </tr>
    <tr>
      <th>II</th>
      <td>C</td>
      <td>U</td>
      <td>S</td>
      <td>B</td>
      <td>O</td>
      <td>Z</td>
    </tr>
    <tr>
      <th>III</th>
      <td>X</td>
      <td>M</td>
      <td>Y</td>
      <td>D</td>
      <td>Y</td>
      <td>B</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>E</td>
      <td>J</td>
      <td>X</td>
      <td>N</td>
      <td>F</td>
      <td>R</td>
    </tr>
    <tr>
      <th>V</th>
      <td>L</td>
      <td>V</td>
      <td>M</td>
      <td>M</td>
      <td>X</td>
      <td>R</td>
    </tr>
    <tr>
      <th>VI</th>
      <td>P</td>
      <td>X</td>
      <td>C</td>
      <td>O</td>
      <td>X</td>
      <td>P</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>top</th>
      <td>V</td>
      <td>Y</td>
      <td>B</td>
      <td>G</td>
      <td>X</td>
      <td>R</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



# 4. 缺失值处理
## 4.1 发现缺失值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>],</span><br><span class="line">                             [np.nan, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">                             [<span class="number">5</span>, <span class="number">6</span>, <span class="literal">None</span>]]), columns=<span class="built_in">list</span>(<span class="string">&#x27;ABC&#x27;</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
      <td>None</td>
    </tr>
  </tbody>
</table>




注意：有None、字符串等，数据类型全部变为object，它比int和float更消耗资源

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.isnull()</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.notnull()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>




## 4.2 删除缺失值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                             [np.nan, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                             [<span class="number">7</span>, <span class="number">8</span>, np.nan, <span class="number">9</span>],</span><br><span class="line">                             [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>]]), columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>




注意：np.nan是一种特殊的浮点数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dtypes</span><br></pre></td></tr></table></figure>


    A    float64
    B    float64
    C    float64
    D    float64
    dtype: object

### 4.2.1 删除整行

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>




### 4.2.2 删除整列

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13.0</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;D&#x27;</span>] = np.nan</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="string">&#x27;columns&#x27;</span>, how=<span class="string">&#x27;all&#x27;</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div>

删除列中全是缺失值的列

### 4.2.3 填充缺失值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                             [np.nan, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                             [<span class="number">7</span>, <span class="number">8</span>, np.nan, <span class="number">9</span>],</span><br><span class="line">                             [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>]]), columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>


* 用均值进行替换

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fill = data.mean()</span><br><span class="line">fill</span><br></pre></td></tr></table></figure>


    A    6.000000
    B    7.666667
    C    6.333333
    D    7.750000
    dtype: float64

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=fill)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>7.666667</td>
      <td>2.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.000000</td>
      <td>6.333333</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.000000</td>
      <td>12.000000</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fill = data.stack().mean()</span><br><span class="line">fill</span><br></pre></td></tr></table></figure>


    7.0

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=fill)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>




.stack是摊平的作用

这个是求整体的平均值

# 5. 合并数据

* 构造一个生产DataFrame的函数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">make_df</span>(<span class="params">cols, ind</span>):</span><br><span class="line">    <span class="string">&#x27;一个简单的DataFrame&#x27;</span></span><br><span class="line">    data = &#123;c:[<span class="built_in">str</span>(c)+<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ind] <span class="keyword">for</span> c <span class="keyword">in</span> cols&#125;</span><br><span class="line">    <span class="keyword">return</span> pd.DataFrame(data,ind)</span><br><span class="line"></span><br><span class="line">make_df(<span class="string">&#x27;ABC&#x27;</span>, <span class="built_in">range</span>(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>




* 垂直合并

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_1 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_2 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(df_1)</span><br><span class="line"><span class="built_in">print</span>(df_2)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    A   B</span><br><span class="line">1  A1  B1</span><br><span class="line">2  A2  B2</span><br><span class="line">    A   B</span><br><span class="line">3  A3  B3</span><br><span class="line">4  A4  B4</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_1, df_2])</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>


* 水平合并

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_3 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_4 = make_df(<span class="string">&#x27;CD&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(df_3)</span><br><span class="line"><span class="built_in">print</span>(df_4)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    A   B</span><br><span class="line"><span class="number">1</span>  A1  B1</span><br><span class="line"><span class="number">2</span>  A2  B2</span><br><span class="line">    C   D</span><br><span class="line"><span class="number">1</span>  C1  D1</span><br><span class="line"><span class="number">2</span>  C2  D2</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_3, df_4], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>




* 重复索引

行索引

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_5 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_6 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(df_5)</span><br><span class="line"><span class="built_in">print</span>(df_6)</span><br></pre></td></tr></table></figure>

        A   B
    1  A1  B1
    2  A2  B2
        A   B
    1  A1  B1
    2  A2  B2

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_5, df_6])</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_5, df_6], ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>




* 列重叠

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_7 = make_df(<span class="string">&#x27;ABC&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_8 = make_df(<span class="string">&#x27;BCD&#x27;</span>, [<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(df_7)</span><br><span class="line"><span class="built_in">print</span>(df_8)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    A   B   C</span><br><span class="line">1  A1  B1  C1</span><br><span class="line">2  A2  B2  C2</span><br><span class="line">    B   C   D</span><br><span class="line">3  B3  C3  D3</span><br><span class="line">4  B4  C4  D4</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_7, df_8], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_7, df_8], axis=<span class="number">1</span>, ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>




* 对其合并merge(）

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_9 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_10 = make_df(<span class="string">&#x27;BC&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(df_9)</span><br><span class="line"><span class="built_in">print</span>(df_10)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    A   B</span><br><span class="line">1  A1  B1</span><br><span class="line">2  A2  B2</span><br><span class="line">    B   C</span><br><span class="line">1  B1  C1</span><br><span class="line">2  B2  C2</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df_9, df_10)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>




* 多级索引：用于多维数据

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_11 = make_df(<span class="string">&#x27;AB&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_12 = make_df(<span class="string">&#x27;CB&#x27;</span>, [<span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(df_11)</span><br><span class="line"><span class="built_in">print</span>(df_12)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    A   B</span><br><span class="line">1  A1  B1</span><br><span class="line">2  A2  B2</span><br><span class="line">    C   B</span><br><span class="line">2  C2  B2</span><br><span class="line">1  C1  B1</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df_9, df_10)</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>


【例】 合并城市信息

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">&#x27;city&#x27;</span>: (<span class="string">&#x27;BeiJing&#x27;</span>, <span class="string">&#x27;ShangHai&#x27;</span>, <span class="string">&#x27;ShenZhen&#x27;</span>),</span><br><span class="line">                   <span class="string">&#x27;population&#x27;</span>: (<span class="number">2189</span>, <span class="number">2487</span>, <span class="number">1756</span>)&#125;</span><br><span class="line"></span><br><span class="line">population = pd.DataFrame(population_dict)</span><br><span class="line">population</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2189</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ShangHai</td>
      <td>2487</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ShenZhen</td>
      <td>1756</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GDP_dict = &#123;<span class="string">&#x27;city&#x27;</span>: (<span class="string">&#x27;BeiJing&#x27;</span>, <span class="string">&#x27;ShangHai&#x27;</span>, <span class="string">&#x27;GuangZhou&#x27;</span>),</span><br><span class="line">                   <span class="string">&#x27;GDP&#x27;</span>: (<span class="number">36102</span>, <span class="number">38700</span>, <span class="number">25019</span>)&#125;</span><br><span class="line">GDP = pd.DataFrame(GDP_dict)</span><br><span class="line">GDP</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>36102</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ShangHai</td>
      <td>38700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GuangZhou</td>
      <td>25019</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info = pd.merge(population, GDP)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2189</td>
      <td>36102</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ShangHai</td>
      <td>2487</td>
      <td>38700</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info = pd.merge(population, GDP, how=<span class="string">&#x27;outer&#x27;</span>)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2189.0</td>
      <td>36102.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GuangZhou</td>
      <td>NaN</td>
      <td>25019.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ShangHai</td>
      <td>2487.0</td>
      <td>38700.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ShenZhen</td>
      <td>1756.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>




# 6. 分组和数据透视表

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;key&#x27;</span>:[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">                  <span class="string">&#x27;data1&#x27;</span>: <span class="built_in">range</span>(<span class="number">6</span>),</span><br><span class="line">                  <span class="string">&#x27;data2&#x27;</span>: np.random.randint(<span class="number">0</span>, <span class="number">10</span>, size=<span class="number">6</span>)&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>




## 6.1 分组
* 延迟计算

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>)</span><br></pre></td></tr></table></figure>


    <pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001E8D53BE210>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>B</th>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>C</th>
      <td>5</td>
      <td>12</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).mean()</span><br></pre></td></tr></table></figure>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>2.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2.5</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>




* 按列取值

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>)[<span class="string">&#x27;data2&#x27;</span>].<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>


    key
    A     8
    B    10
    C    12
    Name: data2, dtype: int32

* 按组迭代

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> data, group <span class="keyword">in</span> df.groupby(<span class="string">&#x27;key&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;0:3&#125; shape=&#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(data, group.shape))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A   shape=(2, 3)</span><br><span class="line">B   shape=(2, 3)</span><br><span class="line">C   shape=(2, 3)</span><br></pre></td></tr></table></figure>

* 调用方法

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>)[<span class="string">&#x27;data1&#x27;</span>].describe()</span><br></pre></td></tr></table></figure>




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>3.535534</td>
      <td>0.0</td>
      <td>1.25</td>
      <td>2.5</td>
      <td>3.75</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>2.121320</td>
      <td>1.0</td>
      <td>1.75</td>
      <td>2.5</td>
      <td>3.25</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>0.707107</td>
      <td>2.0</td>
      <td>2.25</td>
      <td>2.5</td>
      <td>2.75</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>




* 支持更复杂的操作

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).aggregate([<span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;median&#x27;</span>, <span class="string">&#x27;max&#x27;</span>])</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">data1</th>
      <th colspan="3" halign="left">data2</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>2.5</td>
      <td>5</td>
      <td>4</td>
      <td>4.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>2.5</td>
      <td>4</td>
      <td>1</td>
      <td>5.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>2.5</td>
      <td>3</td>
      <td>4</td>
      <td>6.0</td>
      <td>8</td>
    </tr>
  </tbody>
</table>




* 过滤

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">filter_func</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x[<span class="string">&#x27;data1&#x27;</span>].std() &gt; <span class="number">3</span></span><br><span class="line"></span><br><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).<span class="built_in">filter</span>(filter_func)</span><br></pre></td></tr></table></figure>



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>




* 转换

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).transform(<span class="keyword">lambda</span> x:x-x.mean())</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.5</td>
      <td>-4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>




* apply()方法

  groupby().apply() 是 Pandas 中一个非常强大的功能，用于对分组后的数据应用自定义函数。它允许你对每个分组进行复杂的操作，并将结果合并回一个完整的 DataFrame 或 Series。

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">norm_by_data2</span>(<span class="params">x</span>):</span><br><span class="line">    x[<span class="string">&#x27;data1&#x27;</span>] /= x[<span class="string">&#x27;data2&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">    <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;key&#x27;</span>).apply(norm_by_data2, include_groups=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">A</th>
      <th>0</th>
      <td>0.000000</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.625000</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>1</th>
      <td>0.100000</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.400000</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">C</th>
      <th>2</th>
      <td>0.166667</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.250000</td>
      <td>4</td>
    </tr>
  </tbody>
</table>




* 将列表、数组设为分组键

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(L).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACA</td>
      <td>7</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BC</td>
      <td>4</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>




* 用字典将索引映射到分组

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.set_index(<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>C</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>B</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>A</th>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&quot;first&quot;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;constant&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;constant&#x27;</span>&#125;</span><br><span class="line">df2.groupby(mapping).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>constant</th>
      <td>10</td>
      <td>22</td>
    </tr>
    <tr>
      <th>first</th>
      <td>5</td>
      <td>8</td>
    </tr>
  </tbody>
</table>




* 任意Python函数

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.groupby(<span class="built_in">str</span>.lower).mean()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2.5</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>




* 多个有效值组成的列表

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.groupby([<span class="built_in">str</span>.lower, mapping]).mean()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>first</th>
      <td>2.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>b</th>
      <th>constant</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <th>constant</th>
      <td>2.5</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>




【例1】行星观测数据处理

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#import seaborn as sns</span></span><br><span class="line"><span class="comment">#planets = sns.load_dataset(&#x27;planets&#x27;)</span></span><br></pre></td></tr></table></figure>

上述方法的前提是可以正常访问Seaborn的数据服务器，可直接使用load_dataset方法加载数据集。

如果网络受限，会导致下载失败。

如果下载不了，可以登录[GitHub](https://github.com/mwaskom/seaborn-data)或者使用下载[我的源码](https://github.com/)或是使用[百度网盘](https://pan.baidu.com/s/1Emx4J2KeDAS3yOIRkUG4Ag)(提取码：zx9d)

然后执行下面代码加载数据集，注意修改文件地址

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置本地数据集路径</span></span><br><span class="line">data_home = <span class="string">r&#x27;D:\jupyter_notebook\python\assets\dataset\seaborn-data-master&#x27;</span></span><br><span class="line">planets = sns.load_dataset(<span class="string">&#x27;planets&#x27;</span>, data_home=data_home, cache=<span class="literal">True</span>)</span><br><span class="line">planets.head()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.shape</span><br></pre></td></tr></table></figure>


    (1035, 6)

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.describe()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1035.000000</td>
      <td>992.000000</td>
      <td>513.000000</td>
      <td>808.000000</td>
      <td>1035.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.785507</td>
      <td>2002.917596</td>
      <td>2.638161</td>
      <td>264.069282</td>
      <td>2009.070531</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.240976</td>
      <td>26014.728304</td>
      <td>3.818617</td>
      <td>733.116493</td>
      <td>3.972567</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.090706</td>
      <td>0.003600</td>
      <td>1.350000</td>
      <td>1989.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>5.442540</td>
      <td>0.229000</td>
      <td>32.560000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>39.979500</td>
      <td>1.260000</td>
      <td>55.250000</td>
      <td>2010.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>526.005000</td>
      <td>3.040000</td>
      <td>178.500000</td>
      <td>2012.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.000000</td>
      <td>730000.000000</td>
      <td>25.000000</td>
      <td>8500.000000</td>
      <td>2014.000000</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">decade = <span class="number">10</span> * (planets[<span class="string">&#x27;year&#x27;</span>] // <span class="number">10</span>)</span><br><span class="line">decade = decade.astype(<span class="built_in">str</span>) + <span class="string">&#x27;s&#x27;</span></span><br><span class="line">decade.name = <span class="string">&#x27;decade&#x27;</span></span><br><span class="line">decade.head</span><br></pre></td></tr></table></figure>


    <bound method NDFrame.head of 0       2000s
    1       2000s
    2       2010s
    3       2000s
    4       2000s
            ...  
    1030    2000s
    1031    2000s
    1032    2000s
    1033    2000s
    1034    2000s
    Name: decade, Length: 1035, dtype: object>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.groupby([<span class="string">&#x27;method&#x27;</span>, decade]).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
    <tr>
      <th>method</th>
      <th>decade</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <th>2010s</th>
      <td>2</td>
      <td>1.262360e+03</td>
      <td>0.00000</td>
      <td>35.75</td>
      <td>4023</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Eclipse Timing Variations</th>
      <th>2000s</th>
      <td>5</td>
      <td>1.930800e+04</td>
      <td>6.05000</td>
      <td>261.44</td>
      <td>6025</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>10</td>
      <td>2.345680e+04</td>
      <td>4.20000</td>
      <td>1000.00</td>
      <td>12065</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Imaging</th>
      <th>2000s</th>
      <td>29</td>
      <td>1.350935e+06</td>
      <td>0.00000</td>
      <td>956.83</td>
      <td>40139</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>21</td>
      <td>6.803750e+04</td>
      <td>0.00000</td>
      <td>1210.08</td>
      <td>36208</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Microlensing</th>
      <th>2000s</th>
      <td>12</td>
      <td>1.732500e+04</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>20070</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>15</td>
      <td>4.750000e+03</td>
      <td>0.00000</td>
      <td>41440.00</td>
      <td>26155</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <th>2010s</th>
      <td>5</td>
      <td>2.127920e+00</td>
      <td>0.00000</td>
      <td>2360.00</td>
      <td>6035</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Pulsar Timing</th>
      <th>1990s</th>
      <td>9</td>
      <td>1.900153e+02</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>5978</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>1</td>
      <td>3.652500e+04</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>1</td>
      <td>9.070629e-02</td>
      <td>0.00000</td>
      <td>1200.00</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <th>2000s</th>
      <td>1</td>
      <td>1.170000e+03</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>2007</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Radial Velocity</th>
      <th>1980s</th>
      <td>1</td>
      <td>8.388800e+01</td>
      <td>11.68000</td>
      <td>40.57</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>1990s</th>
      <td>52</td>
      <td>1.091561e+04</td>
      <td>68.17820</td>
      <td>723.71</td>
      <td>55943</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>475</td>
      <td>2.633526e+05</td>
      <td>945.31928</td>
      <td>15201.16</td>
      <td>619775</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>424</td>
      <td>1.809630e+05</td>
      <td>316.47890</td>
      <td>11382.67</td>
      <td>432451</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Transit</th>
      <th>2000s</th>
      <td>64</td>
      <td>2.897102e+02</td>
      <td>0.00000</td>
      <td>31823.31</td>
      <td>124462</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>712</td>
      <td>8.087813e+03</td>
      <td>1.47000</td>
      <td>102419.46</td>
      <td>673999</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <th>2010s</th>
      <td>9</td>
      <td>2.393505e+02</td>
      <td>0.00000</td>
      <td>3313.00</td>
      <td>8050</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.groupby([<span class="string">&#x27;method&#x27;</span>, decade])[[<span class="string">&#x27;number&#x27;</span>]].<span class="built_in">sum</span>().unstack().fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>




<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">number</th>
    </tr>
    <tr>
      <th>decade</th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2000s</th>
      <th>2010s</th>
    </tr>
    <tr>
      <th>method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Eclipse Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Imaging</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>29.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Microlensing</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Pulsar Timing</th>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Radial Velocity</th>
      <td>1.0</td>
      <td>52.0</td>
      <td>475.0</td>
      <td>424.0</td>
    </tr>
    <tr>
      <th>Transit</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>712.0</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>




## 6.2 数据透视表

【例2】泰坦尼克号乘客数据分析

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data_home = <span class="string">r&#x27;D:\jupyter_notebook\python\assets\dataset\seaborn-data-master&#x27;</span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>, data_home=data_home, cache=<span class="literal">True</span>)</span><br><span class="line">titanic.head()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.describe()titanic.describe()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.groupby(<span class="string">&#x27;sex&#x27;</span>)[[<span class="string">&#x27;survived&#x27;</span>]].mean()</span><br></pre></td></tr></table></figure>


</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.188908</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.groupby([<span class="string">&#x27;sex&#x27;</span>, <span class="string">&#x27;class&#x27;</span>], observed=<span class="literal">True</span>)[<span class="string">&#x27;survived&#x27;</span>].aggregate(<span class="string">&#x27;mean&#x27;</span>).unstack()</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>




<ul>
<li>数据透视表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(<span class="string">&#x27;survived&#x27;</span>, index=<span class="string">&#x27;sex&#x27;</span>, columns=<span class="string">&#x27;class&#x27;</span>, observed=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(<span class="string">&#x27;survived&#x27;</span>, index=<span class="string">&#x27;sex&#x27;</span>, </span><br><span class="line">                    columns=<span class="string">&#x27;class&#x27;</span>, aggfunc=<span class="string">&#x27;mean&#x27;</span>, observed=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(index=<span class="string">&#x27;sex&#x27;</span>, columns=<span class="string">&#x27;class&#x27;</span>, </span><br><span class="line">                    aggfunc=&#123;<span class="string">&#x27;survived&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>&#125;, observed=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">fare</th>
      <th colspan="3" halign="left">survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>106.125798</td>
      <td>21.970121</td>
      <td>16.118810</td>
      <td>91</td>
      <td>70</td>
      <td>72</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67.226127</td>
      <td>19.741782</td>
      <td>12.661633</td>
      <td>45</td>
      <td>17</td>
      <td>47</td>
    </tr>
  </tbody>
</table>
# 7. 其他

<h2 id="7-1-向量化字符串操作"><a href="#7-1-向量化字符串操作" class="headerlink" title="7.1 向量化字符串操作"></a>7.1 向量化字符串操作</h2><h2 id="7-2-处理时间序列"><a href="#7-2-处理时间序列" class="headerlink" title="7.2 处理时间序列"></a>7.2 处理时间序列</h2><h2 id="7-3-多级索引：用于多维数据"><a href="#7-3-多级索引：用于多维数据" class="headerlink" title="7.3 多级索引：用于多维数据"></a>7.3 多级索引：用于多维数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;region&#x27;</span>: [<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;East&#x27;</span>, <span class="string">&#x27;East&#x27;</span>, <span class="string">&#x27;West&#x27;</span>, <span class="string">&#x27;West&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;product&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;sales&#x27;</span>: [<span class="number">100</span>, <span class="number">200</span>, <span class="number">150</span>, <span class="number">250</span>, <span class="number">120</span>, <span class="number">180</span>, <span class="number">130</span>, <span class="number">190</span>],</span><br><span class="line">    <span class="string">&#x27;quantity&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">25</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">19</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置多级索引</span></span><br><span class="line">df.set_index([<span class="string">&#x27;region&#x27;</span>, <span class="string">&#x27;product&#x27;</span>], inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始数据：&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<pre><code>原始数据：
                sales  quantity
region product                 
North  A          100        10
       B          200        20
South  A          150        15
       B          250        25
East   A          120        12
       B          180        18
West   A          130        13
       B          190        19
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;sales&#x27;</span>]</span><br></pre></td></tr></table></figure>

<pre><code>region  product
North   A          100
        B          200
South   A          150
        B          250
East    A          120
        B          180
West    A          130
        B          190
Name: sales, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;sales&#x27;</span>]</span><br></pre></td></tr></table></figure>


<pre><code>product
A    100
B    200
Name: sales, dtype: int64
</code></pre>
<h2 id="7-4-高性能的Pandas：eval（）"><a href="#7-4-高性能的Pandas：eval（）" class="headerlink" title="7.4 高性能的Pandas：eval（）"></a>7.4 高性能的Pandas：eval（）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建两个大型 DataFrame</span></span><br><span class="line">size = <span class="number">1000000</span>  <span class="comment"># 100万行</span></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;value&#x27;</span>: np.random.rand(size)&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;value&#x27;</span>: np.random.rand(size)&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit (df1[<span class="string">&#x27;value&#x27;</span>] + df2[<span class="string">&#x27;value&#x27;</span>])*df1[<span class="string">&#x27;value&#x27;</span>]/df2[<span class="string">&#x27;value&#x27;</span>]</span><br></pre></td></tr></table></figure>

<pre><code>16.6 ms ± 3.36 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit pd.<span class="built_in">eval</span>(<span class="string">&#x27;(df1.value + df2.value)*df1.value/df2.value&#x27;</span>)</span><br></pre></td></tr></table></figure>


<pre><code>11.7 ms ± 2.25 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre>
<h2 id="7-5-高性能的Pandas：query"><a href="#7-5-高性能的Pandas：query" class="headerlink" title="7.5 高性能的Pandas：query()"></a>7.5 高性能的Pandas：query()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: np.random.rand(<span class="number">1000000</span>),  <span class="comment"># 100万行</span></span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: np.random.rand(<span class="number">1000000</span>),</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: np.random.randint(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1000000</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df[(df[<span class="string">&#x27;A&#x27;</span>] &gt; <span class="number">0.5</span>) &amp; (df[<span class="string">&#x27;B&#x27;</span>] &lt; <span class="number">0.3</span>) &amp; (df[<span class="string">&#x27;C&#x27;</span>] == <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<pre><code>16.1 ms ± 3.3 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df.query(<span class="string">&#x27;A &gt; 0.5 and B &lt; 0.3 and C == 1&#x27;</span>)</span><br></pre></td></tr></table></figure>


<pre><code>23.9 ms ± 703 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre>
<p>在处理小数组时，普通方法反而更快。</p>
<p>eval()和query()的优势主要在处理大量数据时减少了符合代数式中间过程的内存分配</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://ziyuan0315.github.io">ZI YUAN</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ziyuan0315.github.io/2025/03/11/11-Pandas%E5%BA%93/">https://ziyuan0315.github.io/2025/03/11/11-Pandas%E5%BA%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ziyuan0315.github.io" target="_blank">‘太湖之光也有报错的情况'</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/the_Alps.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav id="pagination"><div class="pagination"></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ziyuan.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ZI YUAN</div><div class="author-info-description">出现bug可能不是你的问题，可能是底层或者硬件问题（doge）</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ziyuan0315/ziyuan0315.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="/songziyuan666@126.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/03/13/13.Sklearn%E5%BA%93/" title="13.Sklearn库"><img src="/img/Jura%20Mountains.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="13.Sklearn库"/></a><div class="content"><a class="title" href="/2025/03/13/13.Sklearn%E5%BA%93/" title="13.Sklearn库">13.Sklearn库</a><time datetime="2025-03-13T07:52:21.000Z" title="发表于 2025-03-13 15:52:21">2025-03-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/12-Matplotlib%E5%BA%93/" title="12.Matplotlib库"><img src="/img/guilin.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="12.Matplotlib库"/></a><div class="content"><a class="title" href="/2025/03/11/12-Matplotlib%E5%BA%93/" title="12.Matplotlib库">12.Matplotlib库</a><time datetime="2025-03-11T07:52:21.000Z" title="发表于 2025-03-11 15:52:21">2025-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/11-Pandas%E5%BA%93/" title="11.Pandas库"><img src="/img/the_Alps.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="11.Pandas库"/></a><div class="content"><a class="title" href="/2025/03/11/11-Pandas%E5%BA%93/" title="11.Pandas库">11.Pandas库</a><time datetime="2025-03-11T07:50:51.000Z" title="发表于 2025-03-11 15:50:51">2025-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/10-Numpy%E5%BA%93/" title="10.Numpy库"><img src="/img/Fujiyama.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="10.Numpy库"/></a><div class="content"><a class="title" href="/2025/03/11/10-Numpy%E5%BA%93/" title="10.Numpy库">10.Numpy库</a><time datetime="2025-03-11T07:50:31.000Z" title="发表于 2025-03-11 15:50:31">2025-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/09-Python%E6%A0%87%E5%87%86%E5%BA%93/" title="09.Python标准库"><img src="/img/Swan%20Castle.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="09.Python标准库"/></a><div class="content"><a class="title" href="/2025/03/11/09-Python%E6%A0%87%E5%87%86%E5%BA%93/" title="09.Python标准库">09.Python标准库</a><time datetime="2025-03-11T07:50:06.000Z" title="发表于 2025-03-11 15:50:06">2025-03-11</time></div></div></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>归档</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/03/">
            <span class="card-archive-list-date">
              三月 2025
            </span>
            <span class="card-archive-list-count">16</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">16</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总浏览量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-03-13T14:32:25.801Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/winter1.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By ZI YUAN</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>